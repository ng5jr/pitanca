<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>LA PAPA DE MANIOBRAS</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Usa la imagen de la carpeta como favicon -->
    <link rel="icon" type="image/jpg" href="./Captura.JPG" />
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0 0.5em;
        background: #181c24;
        color: #f1f1f1;
      }
      .titulo-con-icono {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5em;
      }
      .titulo-con-icono img {
        width: 32px;
        height: 32px;
        vertical-align: middle;
      }
      img {
        border-radius: 100%;
      }
      h1 {
        font-size: 1.5em;
        text-align: center;
        margin: 1em 0 0.5em 0;
        color: #fff;
        font-weight: bold;
      }
      form {
        max-width: 600px;
        margin: 0 auto;
        background: #23283a;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        padding: 1em;
      }
      .question-header {
        display: flex;
        align-items: center;
        gap: 0.5em;
      }
      .question-result {
        font-size: 1.3em;
        margin-left: 0.3em;
        vertical-align: middle;
      }
      h3 {
        font-size: 1.1em;
        margin-top: 1.5em;
        margin-bottom: 0.5em;
        color: #e3e3e3;
      }
      label {
        display: flex;
        align-items: center;
        font-size: 1em;
        padding: 0.4em 0.2em;
        border-radius: 4px;
        transition: background 0.2s;
        cursor: pointer;
        word-break: break-word;
        color: #f1f1f1;
      }
      input[type="checkbox"] {
        margin-right: 0.7em;
        accent-color: #00bfff;
        transform: scale(1.2);
      }
      .correct-answer {
        background-color: #234d2b;
        color: #b6ffb6;
      }
      button {
        width: 100%;
        padding: 0.8em;
        margin-top: 1.5em;
        font-size: 1.1em;
        background: #00bfff;
        color: #181c24;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
        transition: background 0.2s;
      }
      button:hover {
        background: #0099cc;
      }
      #result {
        max-width: 600px;
        margin: 1.5em auto 2em auto;
        background: #23283a;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        padding: 1em;
        font-size: 1em;
        color: #fff;
        display: none;
      }
      .canvas-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 1em 0;
        padding: 10px;
        background: #29304b;
        border-radius: 8px;
      }
      .canvas-row {
        display: flex;
        justify-content: center;
        gap: 20px;
        width: 100%;
        flex-wrap: wrap;
      }
      canvas {
        border: 1px solid #ccc;
        border-radius: 4px;
        background: #fff;
      }
      #shipCanvas,
      #resultantCanvas {
        background-color: #ffffff; /* Cambiado a blanco */
        border: 2px solid #3b4562;
        border-radius: 4px;
        cursor: crosshair;
        max-width: 100%;
      }
      #clearCanvas {
        padding: 5px 10px;
        background: #c33;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9em;
        transition: background 0.2s;
      }
      #clearCanvas:hover {
        background: #b22;
      }
      input[type="color"] {
        width: 30px;
        height: 30px;
        border: none;
        padding: 0;
        cursor: pointer;
      }
      input[type="range"] {
        width: 80px;
      }
      .canvas-row h4 {
        color: #ffffff;
        margin: 0 0 10px 0;
        text-align: center;
        background: #2a3450;
        padding: 5px;
        border-radius: 4px;
      }
      .canvas-controls button {
        padding: 5px 10px;
        margin: 0 5px;
        background: #34395e;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.85em;
        transition: background 0.2s;
        max-width: 130px;
        width: auto;
      }

      .canvas-controls button:hover {
        background: #474f79;
      }

      .canvas-controls #clearCanvas,
      .canvas-controls [id^="clearCanvas_"] {
        background: #c33;
      }

      .canvas-controls #clearCanvas:hover,
      .canvas-controls [id^="clearCanvas_"]:hover {
        background: #b22;
      }

      .canvas-controls {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 10px;
      }

      @media (max-width: 600px) {
        form,
        #result {
          padding: 0.7em;
        }
        h1 {
          font-size: 1.1em;
        }
        h3 {
          font-size: 1em;
        }
        button {
          font-size: 1em;
        }
        .question-header {
          font-size: 0.98em;
        }
        .titulo-con-icono img {
          width: 22px;
          height: 22px;
        }
        .question-header[data-q^="2"]:not([data-q="2.1"]):not([data-q="2.2"]),
        .canvas-instructions,
        .canvas-container {
          display: none !important;
        }
      }
    </style>
  </head>
  <body>
    <div class="titulo-con-icono">
      <img src="./Captura.JPG" alt="icono papa" />
      <h1>LA PAPA DE MANIOBRAS PARA PITANCA</h1>
      <img src="./gilarda.JPG" alt="icono gilarda" />
    </div>
    <form id="quizForm">
      <!-- Cambia cada h3 por un div con class="question-header" y el h3 adentro -->
      <div class="question-header" data-q="1">
        <h3>1 Una alta relación Eslora/Manga hace que:</h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="1" value="a" /> Se tenga una mala
        estabilidad direccional</label
      ><br />
      <label
        ><input type="checkbox" name="1" value="b" /> Se tenga una buena
        capacidad de maniobra</label
      ><br />
      <label
        ><input type="checkbox" name="1" value="c" /> Se tenga una buena
        estabilidad direccional</label
      ><br />
      <label
        ><input type="checkbox" name="1" value="d" /> Se tenga una mala
        capacidad de maniobra</label
      ><br />
      <div class="question-header" data-q="1.1">
        <h3>
          1.1. Si un primer buque tiene una relación eslora-manga más chica que
          un segundo, podemos esperar que:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="1.1" value="a" /> El 1er tenga mejor
        capacidad de maniobrar</label
      ><br />
      <label
        ><input type="checkbox" name="1.1" value="b" /> El 2do tenga mayor
        estabilidad direccional</label
      ><br />
      <label
        ><input type="checkbox" name="1.1" value="c" /> El 2do tenga mejor
        respuesta al maniobrar</label
      ><br />
      <label
        ><input type="checkbox" name="1.1" value="d" /> El 1er tenga mayor
        estabilidad direccional</label
      ><br />

      <div class="question-header" data-q="1.2">
        <h3>
          1.2. Si un primer buque tiene una relación eslora-manga más grande que
          un segundo, podemos esperar que:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="1.2" value="a" /> El 1er tenga mejor
        capacidad de maniobrar</label
      ><br />
      <label
        ><input type="checkbox" name="1.2" value="b" /> El 2do tenga mayor
        estabilidad direccional</label
      ><br />
      <label
        ><input type="checkbox" name="1.2" value="c" /> El 2do tenga mejor
        respuesta al maniobrar</label
      ><br />
      <label
        ><input type="checkbox" name="1.2" value="d" /> El 1er tenga mayor
        estabilidad direccional</label
      ><br />

      <div class="question-header" data-q="2.1">
        <h3>2.1. Qué pasa con el Punto Pivot al navegar aproado?</h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="2.1" value="a" /> Se corre más a proa de
        la posición que tiene al navegar con calados parejos</label
      ><br />
      <label
        ><input type="checkbox" name="2.1" value="b" /> Se traslada cerca de la
        sección media del buque</label
      ><br />
      <label
        ><input type="checkbox" name="2.1" value="c" /> Queda más a proa de la
        sección media del buque</label
      ><br />
      <label
        ><input type="checkbox" name="2.1" value="d" /> No se altera la posición
        del Punto Pivot</label
      ><br />

      <div class="question-header" data-q="2.2">
        <h3>2.2. Qué pasa con el Punto Pivot al navegar apopado?</h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="2.2" value="a" /> Se corre más a proa de
        la posición que tiene al navegar con calados parejos</label
      ><br />
      <label
        ><input type="checkbox" name="2.2" value="b" /> Se traslada cerca de la
        sección media del buque</label
      ><br />
      <label
        ><input type="checkbox" name="2.2" value="c" /> Queda más a proa de la
        sección media del buque</label
      ><br />
      <label
        ><input type="checkbox" name="2.2" value="d" /> No se altera la posición
        del Punto Pivot</label
      ><br />

      <div class="question-header" data-q="3.1">
        <h3>
          3.1. En un primer buque con menor Cb respecto a otro segundo de
          similares dimensiones pero con MAYOR Cb, se puede esperar que:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="3.1" value="a" /> El primero tenga curvas
        evolutivas más amplias</label
      ><br />
      <label
        ><input type="checkbox" name="3.1" value="b" /> El primero tenga curvas
        evolutivas más pequeñas</label
      ><br />
      <label
        ><input type="checkbox" name="3.1" value="c" /> No varíe la amplitud de
        sus curvas evolutivas</label
      ><br />
      <label
        ><input type="checkbox" name="3.1" value="d" /> El segundo tenga curvas
        evolutivas más pequeñas</label
      ><br />

      <div class="question-header" data-q="3.2">
        <h3>
          3.2. En un primer buque con MAYOR Cb respecto a otro segundo de
          similares dimensiones pero con menor Cb, se puede esperar que:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="3.2" value="a" /> El primero tenga curvas
        evolutivas más amplias</label
      ><br />
      <label
        ><input type="checkbox" name="3.2" value="b" /> El primero tenga curvas
        evolutivas más pequeñas</label
      ><br />
      <label
        ><input type="checkbox" name="3.2" value="c" /> No varíe la amplitud de
        sus curvas evolutivas</label
      ><br />
      <div class="question-header" data-q="3.3">
        <h3>
          3.3. En un buque con calados parejos y con alto Cb y en presencia de
          squat por bajofondos se puede esperar que:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="3.3" value="a" /> El buque tienda a
        aumentar su calado máximo</label
      ><br />
      <label
        ><input type="checkbox" name="3.3" value="b" /> El buque tienda a
        aproarse</label
      ><br />
      <label
        ><input type="checkbox" name="3.3" value="c" /> El buque tienda a
        apoparse</label
      ><br />

      <div class="question-header" data-q="4">
        <h3>
          4. En general, un buque bien cargado respecto al mismo liviano es:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="4" value="a" /> Más fácil de gobernar en
        cuanto a mantener el arrumbamiento</label
      ><br />
      <label
        ><input type="checkbox" name="4" value="b" /> Más fácil de detener en
        cuanto a la distancia de parada</label
      ><br />
      <label
        ><input type="checkbox" name="4" value="c" /> Más difícil de gobernar en
        cuanto a cambiar de arrumbamiento</label
      ><br />
      <label
        ><input type="checkbox" name="4" value="d" /> Más difícil de detener en
        cuanto a la distancia de parada</label
      ><br />

      <div class="question-header" data-q="5.1">
        <h3>
          5.1. Dificultad de gobierno de un buque con mucha superestructura en
          proa respecto a uno con superestructura a popa:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="5.1" value="a" /> Es más fácil de gobernar
        con superestructura a proa porque el puente está más cerca de la
        proa</label
      ><br />
      <label
        ><input type="checkbox" name="5.1" value="b" /> Es más fácil de gobernar
        con superestructura a popa porque el puente está cerca de los elementos
        de gobierno</label
      ><br />
      <label
        ><input type="checkbox" name="5.1" value="c" /> Es más difícil de
        gobernar con superestructura a popa porque el efecto del viento se
        ejerce más cerca de los elementos de gobierno</label
      ><br />
      <label
        ><input type="checkbox" name="5.1" value="d" /> Es más fácil de gobernar
        con superestructura a proa porque el efecto del viento se ejerce más
        cerca de los elementos de gobierno</label
      ><br />
      <label
        ><input type="checkbox" name="5.1" value="e" /> Es más fácil de gobernar
        con superestructura a popa porque el efecto del viento se ejerce más
        cerca de los elementos de gobierno</label
      ><br />

      <div class="question-header" data-q="5.2">
        <h3>
          5.2 En una hélice CPP a iguales rotaciones (RPM), el empuje es igual
          con el mismo ángulo de ataque en marcha adelante que en marcha atrás?:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="5.2" value="a" /> Sí, los empujes son
        aproximadamente iguales.</label
      ><br />
      <label
        ><input type="checkbox" name="5.2" value="b" /> Es mayor el empuje con
        igual ángulo de ataque en marcha adelante.</label
      ><br />
      <label
        ><input type="checkbox" name="5.2" value="c" /> Es menor el empuje con
        igual ángulo de ataque en marcha adelante.</label
      ><br />
      <label
        ><input type="checkbox" name="5.2" value="d" /> El empuje no depende de
        las rotaciones.</label
      ><br />

      <div class="question-header" data-q="6.1">
        <h3>
          6.1 Si un buque entra en aguas someras, se puede esperar que la
          trayectoria evolutiva al caer sea:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="6.1" value="a" /> De mayores dimensiones
        que en aguas profundas.</label
      ><br />
      <label
        ><input type="checkbox" name="6.1" value="b" /> Con un ROT mayor que en
        aguas profundas.</label
      ><br />
      <label
        ><input type="checkbox" name="6.1" value="c" /> Con un ROT menor que en
        aguas profundas.</label
      ><br />
      <label
        ><input type="checkbox" name="6.1" value="d" /> Que el ROT aumente en
        aguas someras.</label
      ><br />
      <label
        ><input type="checkbox" name="6.1" value="e" /> Que el ROT disminuya en
        aguas someras.</label
      ><br />
      <label
        ><input type="checkbox" name="6.1" value="f" /> No varía el ROT pero
        disminuye la velocidad.</label
      ><br />
      <label
        ><input type="checkbox" name="6.1" value="g" /> Que no se modifique el
        ROT.</label
      ><br />

      <div class="question-header" data-q="6.2">
        <h3>
          6.2 Si un buque sale de aguas someras, se puede esperar que la
          trayectoria evolutiva al caer sea:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="6.2" value="a" /> De mayores dimensiones
        que en aguas someras.</label
      ><br />
      <label
        ><input type="checkbox" name="6.2" value="b" /> Con un ROT mayor que en
        aguas poco profundas.</label
      ><br />
      <label
        ><input type="checkbox" name="6.2" value="c" /> Con un ROT menor que en
        aguas poco profundas.</label
      ><br />
      <label
        ><input type="checkbox" name="6.2" value="d" /> No varía el ROT pero
        aumente la velocidad.</label
      ><br />

      <div class="question-header" data-q="6.3">
        <h3>
          6.3 Si debe planificar una derrota en aguas restringidas donde debe
          efectuar varias caidas de rumbo, Ud. prefiere planificar las caídas
          según:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="6.3" value="a" /> Planificar las caídas
        estableciendo un ROT constante.</label
      ><br />
      <label
        ><input type="checkbox" name="6.3" value="b" /> Planificar las caídas
        planificando un Radio constante.</label
      ><br />
      <label
        ><input type="checkbox" name="6.3" value="c" /> Es indistinto.</label
      ><br />

      <div class="question-header" data-q="7">
        <h3>
          7. En un buque que tiene un cabo firme a tierra por la proa, si
          accionamos el Motor Ppal. con el Timón hacia la banda de tierra, el
          Punto Pivot se mueve hacia:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="7" value="a" /> La sección maestra de la
        carena</label
      ><br />
      <label
        ><input type="checkbox" name="7" value="b" /> Se mantenga entre la
        sección media y la proa</label
      ><br />
      <label
        ><input type="checkbox" name="7" value="c" /> Se traslada hasta el punto
        del portaespía del cabo.</label
      ><br />

      <div class="question-header" data-q="8.1">
        <h3>
          8.1 Si en un Buque Detenido con Hélice Dextrógira se da Marcha Atrás
          con el Timón a Estribor, ¿cómo evoluciona el buque?
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="8.1" value="a" /> Primero la proa cae a Er
        y luego continúa cayendo a Er pero con menos intensidad.</label
      ><br />
      <label
        ><input type="checkbox" name="8.1" value="b" /> Primero la proa cae a Er
        y luego con más fuerza a Er.</label
      ><br />
      <label
        ><input type="checkbox" name="8.1" value="c" /> Primero la proa cae a Br
        y luego comienza a caer a Er.</label
      ><br />

      <div class="question-header" data-q="8.2">
        <h3>
          8.2 Si en un Buque Detenido con Hélice Dextrógira se da Marcha Atrás
          con el Timón a Babor, ¿cómo evoluciona el buque?
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="8.2" value="a" /> Primero la proa cae a Er
        y luego continúa cayendo a Er pero con más intensidad.</label
      ><br />
      <label
        ><input type="checkbox" name="8.2" value="b" /> Primero la proa cae a Br
        y luego con más fuerza a Br.</label
      ><br />
      <label
        ><input type="checkbox" name="8.2" value="c" /> Primero la proa cae a Br
        y luego comienza a caer a Er.</label
      ><br />

      <div class="question-header" data-q="9.1">
        <h3>
          9.1 Un buque de Hélice Dextrógira, que arranca Marcha Adelante con
          Timón puesto a Estribor, ¿cómo evoluciona?
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="9.1" value="a" /> Comienza a caer primero
        a Br por efecto de giro de la hélice y luego a Er por efecto del
        timón.</label
      ><br />
      <label
        ><input type="checkbox" name="9.1" value="b" /> Comienza a caer primero
        a Er y continua esta caída aumentando el ROT</label
      ><br />
      <label
        ><input type="checkbox" name="9.1" value="c" /> Comienza a caer a Er y
        luego con menos intensidad porque adquiere velocidad.</label
      ><br />

      <div class="question-header" data-q="9.2">
        <h3>
          9.2 Un buque con Hélice Dextrógira, que arranca con Marcha Adelante
          con Timón puesto a Babor, ¿cómo evoluciona?
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="9.2" value="a" /> Comienza a caer primero
        a Er por efecto de giro de la hélice y luego a Br por efecto del
        timón.</label
      ><br />
      <label
        ><input type="checkbox" name="9.2" value="b" /> Comienza a caer primero
        a Br y continúa esta caída a medida que adquiere velocidad.</label
      ><br />
      <label
        ><input type="checkbox" name="9.2" value="c" /> Comienza a caer a Er y
        luego con menos intensidad porque adquiere velocidad.</label
      ><br />

      <div class="question-header" data-q="10">
        <h3>
          10. Si un buque detenido (flotando libre), se cobra un cabo hecho
          firme a tierra por la popa, el punto Pivot se ubica? (SIN MAQUINA)
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="10" value="a" /> Entre la sección media y
        la proa.</label
      ><br />
      <label
        ><input type="checkbox" name="10" value="b" /> Muy cerca de la
        roda.</label
      ><br />
      <label
        ><input type="checkbox" name="10" value="c" /> Hacia popa de la zona
        media del buque.</label
      ><br />
      <label
        ><input type="checkbox" name="10" value="d" /> En el porta espía del
        cabo hecho firme.</label
      ><br />

      <div class="question-header" data-q="11.1">
        <h3>
          11.1 Si un buque tiene igual manga, velocidad y área de timón respecto
          de otro buque que solo difiere que tiene el doble de eslora, ¿cómo es
          el momento evolutivo de un buque respecto del otro?
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="11.1" value="a" /> Mayor en el que tiene
        mayor eslora</label
      ><br />
      <label><input type="checkbox" name="11.1" value="b" /> Iguales</label
      ><br />
      <label
        ><input type="checkbox" name="11.1" value="c" /> El doble en el que
        tiene menos eslora</label
      ><br />
      <label
        ><input type="checkbox" name="11.1" value="d" /> Es menor en el Primer
        buque</label
      ><br />
      <label
        ><input type="checkbox" name="11.1" value="e" /> Un buque corto
        evoluciona en un menor número de esloras que uno largo de similar
        tecnología.</label
      ><br />

      <div class="question-header" data-q="11.2">
        <h3>
          11.2 Si un buque tiene igual eslora, velocidad y área de timón
          respecto de otro buque que solo difiere que tiene el doble de manga,
          ¿cómo es el momento evolutivo de un buque respecto del otro?
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="11.2" value="a" /> Mayor en el que tiene
        mayor manga</label
      ><br />
      <label><input type="checkbox" name="11.2" value="b" /> Iguales</label
      ><br />
      <label
        ><input type="checkbox" name="11.2" value="c" /> El doble en el que
        tiene menos manga</label
      ><br />

      <div class="question-header" data-q="11.3">
        <h3>
          11.3 Si un buque tiene igual velocidad y área de timón respecto de
          otro buque que solo difiere que tiene el doble de eslora y manga,
          ¿cómo es el momento evolutivo de un buque respecto del otro?
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="11.3" value="a" /> Mayor en el Primer
        Buque</label
      ><br />
      <label><input type="checkbox" name="11.3" value="b" /> Iguales</label
      ><br />
      <label
        ><input type="checkbox" name="11.3" value="c" /> Es menor en el Primer
        buque</label
      ><br />

      <div class="question-header" data-q="12.1">
        <h3>
          12.1 La relación que vincula los parámetros que definen el ROT es: Vb:
          velocidad del buque /// r: radio de la curva evolutiva
        </h3>
        <span class="question-result"></span>
      </div>
      <label><input type="checkbox" name="12.1" value="a" /> ROT: Vb x r</label
      ><br />
      <label
        ><input type="checkbox" name="12.1" value="b" /> ROT: Vb x t/r</label
      ><br />
      <label><input type="checkbox" name="12.1" value="c" /> ROT: Vb/r</label
      ><br />
      <label
        ><input type="checkbox" name="12.1" value="d" /> Ninguna de las
        anteriores.</label
      ><br />

      <div class="question-header" data-q="12.2">
        <h3>
          12.2 La relación que vincula los parámetros que definen el ROT es: Vb:
          velocidad del buque /// r: radio de la curva evolutiva
        </h3>
        <span class="question-result"></span>
      </div>
      <label><input type="checkbox" name="12.2" value="a" /> ROT: 2Vb/D</label
      ><br />
      <label><input type="checkbox" name="12.2" value="b" /> ROT: Vb x r</label
      ><br />
      <label
        ><input type="checkbox" name="12.2" value="c" /> ROT: Vb x t/r</label
      ><br />
      <label
        ><input type="checkbox" name="12.2" value="d" /> Ninguna de las
        anteriores.</label
      ><br />

      <div class="question-header" data-q="13">
        <h3>
          13. Indique en los parámetros básicos de una curva evolutiva su valor
          aproximado en esloras:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="13" value="a" /> AVANCE = 4 A 5
        ESLORAS</label
      ><br />
      <label
        ><input type="checkbox" name="13" value="b" /> TRASLADO = 1
        ESLORA</label
      ><br />
      <label
        ><input type="checkbox" name="13" value="c" /> DIÁMETRO FINAL = 3 A 5
        ESLORAS</label
      ><br />
      <label
        ><input type="checkbox" name="13" value="d" /> DIÁMETRO TÁCTICO = 4 A 6
        ESLORAS</label
      ><br />
      <label
        ><input type="checkbox" name="13" value="e" /> ANGULO DE DERIVA = DE 8°
        A 15°</label
      ><br />

      <div class="question-header" data-q="14">
        <h3>14. La presencia de Squat en un buque aproado origina que:</h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="14" value="a" /> Disminuya la capacidad de
        maniobrar</label
      ><br />
      <label
        ><input type="checkbox" name="14" value="b" /> Aumente la estabilidad
        direccional</label
      ><br />
      <label
        ><input type="checkbox" name="14" value="c" /> Aumente el asiento del
        buque.</label
      ><br />
      <label
        ><input type="checkbox" name="14" value="d" /> Aumenta la diferencia
        entre el calado de Pr y Pp.</label
      ><br />

      <div class="question-header" data-q="16.1">
        <h3>
          16.1 A MAYOR Velocidad de Avance, de un buque en caída estable a
          Estribor, modifica el tamaño de la curva evolutiva a saber:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="16.1" value="a" /> La disminuye en forma
        muy significativa</label
      ><br />
      <label
        ><input type="checkbox" name="16.1" value="b" /> La disminuye en forma
        no muy significativa</label
      ><br />
      <label
        ><input type="checkbox" name="16.1" value="c" /> La aumenta en forma no
        muy significativa</label
      ><br />

      <div class="question-header" data-q="16.2">
        <h3>
          16.2 A MAYOR Velocidad de Avance, de un buque en caída estable a
          Babor, modifica el tamaño de la curva evolutiva a saber:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="16.2" value="a" /> La disminuye en forma
        muy significativa</label
      ><br />
      <label
        ><input type="checkbox" name="16.2" value="b" /> La disminuye en forma
        no muy significativa</label
      ><br />
      <label
        ><input type="checkbox" name="16.2" value="c" /> La aumenta en forma no
        muy significativa</label
      ><br />

      <div class="question-header" data-q="17.1">
        <h3>
          17.1 Si en un buque ponemos Maquina Dextrógira se pone Todo Adelante y
          Timón a Babor y el Bow Thruster todo a Estribor, podemos esperar que
          el Punto Pivot:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="17.1" value="a" /> Se traslade hacia la
        sección media de la carena</label
      ><br />
      <label
        ><input type="checkbox" name="17.1" value="b" /> Se ubique
        aproximadamente a 1⁄3 de la eslora a medir desde la roda</label
      ><br />
      <label
        ><input type="checkbox" name="17.1" value="c" /> Se traslade hacia proa
        más allá de la roda dependiendo de la relación de empujes entre la popa
        y la proa.</label
      ><br />
      <label
        ><input type="checkbox" name="17.1" value="d" /> Se traslade hacia la
        popa más allá del espejo dependiendo de la relación de empujes entre la
        popa y la proa.</label
      ><br />

      <div class="question-header" data-q="17.2">
        <h3>
          17.2 Si en un buque ponemos Maquina Dextrógira se pone Todo Adelante y
          Timón a Estribor y el Bow Thruster todo a Babor, podemos esperar que
          el Punto Pivot:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="17.2" value="a" /> Se traslade hacia la
        sección media de la carena</label
      ><br />
      <label
        ><input type="checkbox" name="17.2" value="b" /> Se ubique
        aproximadamente a 1⁄3 de la eslora a medir desde la roda</label
      ><br />
      <label
        ><input type="checkbox" name="17.2" value="c" /> Se traslade hacia proa
        más allá de la roda dependiendo de la relación de empujes entre la popa
        y la proa.</label
      ><br />
      <label
        ><input type="checkbox" name="17.2" value="d" /> Se traslade hacia la
        popa más allá del espejo dependiendo de la relación de empujes entre la
        popa y la proa.</label
      ><br />

      <div class="question-header" data-q="17.3">
        <h3>
          17.3 Si en un buque ponemos Maquina Dextrógira se pone Todo Adelante y
          Timón a Babor y el Bow Thruster todo a Babor, podemos esperar que el
          Punto Pivot:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="17.3" value="a" /> Se traslade hacia la
        sección media de la carena</label
      ><br />
      <label
        ><input type="checkbox" name="17.3" value="b" /> Se ubique
        aproximadamente a 1⁄3 de la eslora a medir desde la roda</label
      ><br />
      <label
        ><input type="checkbox" name="17.3" value="c" /> Se traslade hacia proa
        más allá de la roda dependiendo de la relación de empujes entre la popa
        y la proa.</label
      ><br />
      <label
        ><input type="checkbox" name="17.3" value="d" /> Se traslade hacia la
        popa más allá del espejo dependiendo de la relación de empujes entre la
        popa y la proa.</label
      ><br />

      <div class="question-header" data-q="17.4">
        <h3>
          17.4 Si en un buque ponemos Maquina Dextrógira se pone Todo Atrás y
          Timón a Babor y el Bow Thruster todo a Babor, podemos esperar que el
          Punto Pivot:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="17.4" value="a" /> Se traslade hacia la
        sección media de la carena</label
      ><br />
      <label
        ><input type="checkbox" name="17.4" value="b" /> Se ubique
        aproximadamente a 1⁄3 de la eslora a medir desde la roda</label
      ><br />
      <label
        ><input type="checkbox" name="17.4" value="c" /> Se traslade hacia proa
        más allá de la roda dependiendo de la relación de empujes entre la popa
        y la proa.</label
      ><br />
      <label
        ><input type="checkbox" name="17.4" value="d" /> Se traslade hacia la
        popa más allá del espejo dependiendo de la relación de empujes entre la
        popa y la proa.</label
      ><br />
      <div class="question-header" data-q="17.5">
        <h3>
          17.5 Si en un buque ponemos el MP todo atrás el timón todo a babor y
          el Bow-Thruster todo a estribor, podemos esperar que el punto pivot:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="17.5" value="a" /> Se traslade hacia proa
        más allá de la roda dependiendo de la relación de emopujes entre popa y
        proa</label
      ><br />
      <label
        ><input type="checkbox" name="17.5" value="b" /> Se ubique entre la proa
        y la zona media de la eslora del buque</label
      ><br />
      <label
        ><input type="checkbox" name="17.5" value="c" /> Se traslade hacia popa
        más allá del espejo dependiendo de la relación de empujes entre popa y
        proa.</label
      ><br />
      <label
        ><input type="checkbox" name="17.5" value="d" /> Se ubique entre la
        sección media del buque y la popa pero más cerca de la sección
        media.</label
      ><br />

      <div class="question-header" data-q="18">
        <h3>
          18. Si en un buque ponemos Maquina Dextrógira se pone Todo Atrás y el
          Timón a Babor y el Bow Thruster todo a Estribor podemos esperar que el
          Punto Pivot:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="18" value="a" /> Se traslade hacia la proa
        más allá de la roda dependiendo de la relación de empujes entre popa y
        proa.</label
      ><br />
      <label
        ><input type="checkbox" name="18" value="b" /> Se ubique entre la proa y
        la zona media de la eslora del buque.</label
      ><br />
      <label
        ><input type="checkbox" name="18" value="c" /> Se traslade hacia popa
        más allá del espejo dependiendo de la relación de empujes entre popa y
        proa.</label
      ><br />
      <label
        ><input type="checkbox" name="18" value="d" /> Se ubique entre la
        sección media del buque y la popa pero más cerca de la sección
        media.</label
      ><br />

      <div class="question-header" data-q="19">
        <h3>
          19. Si en un buque sin arrancada, acciono un Stern Thruster puedo
          esperar que el Punto Pivot se traslade hacia:
        </h3>
        <span class="question-result"></span>
      </div>
      <label
        ><input type="checkbox" name="19" value="a" /> Aproximadamente hasta 1⁄3
        de la eslora a medir desde el espejo</label
      ><br />
      <label
        ><input type="checkbox" name="19" value="b" /> Hasta el centro de
        resistencia de la carena</label
      ><br />
      <label
        ><input type="checkbox" name="19" value="c" /> Más hacia popa del medio
        de la eslora-manga</label
      ><br />
      <label
        ><input type="checkbox" name="19" value="d" /> Hasta cerca de 1⁄3 de la
        eslora a medir desde la roda</label
      ><br />
      <label
        ><input type="checkbox" name="19" value="e" /> Hacia el centro de
        gravedad de la obra viva</label
      ><br />

      <div class="question-header" data-q="20">
        <h3>
          20. En un buque Monohélice CPP Levógira, con Timón a Er, 10 Ns Avante
          y Maquina Toda Atrás. Dibuje las distintas fuerzas que intervienen en
          la popa y su resultante e indique hacia donde cae la Proa. Dicho buque
          con Maquina Atrás: se comporta igual que un Monohélice FPP Dextrógira
        </h3>
        <span class="question-result"></span>
      </div>
      <div class="canvas-container">
        <div class="canvas-row">
          <div>
            <h4>Dibuja aquí:</h4>
            <canvas id="shipCanvas" width="400" height="300"></canvas>
          </div>
          <div>
            <h4>Vector resultante:</h4>
            <canvas id="resultantCanvas" width="400" height="300"></canvas>
          </div>
        </div>
        <div class="canvas-controls">
          <button type="button" id="clearCanvas">Borrar dibujo</button>
          <button type="button" id="deshacer">Deshacer Ultimo</button>
          <span>Color: </span>
          <input type="color" id="strokeColor" value="#FF0000" />
        </div>
      </div>

      <div style="display: flex; gap: 10px; margin-top: 1.5em">
        <button type="button" onclick="checkAnswers()">Corregir</button>
        <button
          type="button"
          onclick="location.reload()"
          style="background: #ff5555; color: white"
        >
          REINICIAR
        </button>
      </div>
    </form>
    <p id="result"></p>
    <script>
      // Haz que correct sea global
      let correct = {
        1: ["c", "d"],
        1.1: ["a", "b"],
        1.2: ["c", "d"],
        2.1: ["a", "c"],
        2.2: ["b", "c"],
        3.1: ["a", "d"],
        3.2: ["b"],
        3.3: ["a", "b"],
        4: ["a", "c", "d"],
        5.1: ["e"],
        5.2: ["b"],
        6.1: ["a", "c", "e"],
        6.2: ["b"],
        6.3: ["b"],
        7: ["b"],
        8.1: ["a"],
        8.2: ["a"],
        9.1: ["c"],
        9.2: ["b"],
        10: ["a"],
        11.1: ["a", "d", "e"],
        11.2: ["b"],
        11.3: ["c"],
        12.1: ["c"],
        12.2: ["a"],
        13: ["a", "b", "c", "d", "e"],
        14: ["a", "c", "d"],
        16.1: ["c"],
        16.2: ["c"],
        17.1: ["c", "d"],
        17.2: ["c", "d"],
        17.3: ["a"],
        17.4: ["c", "d"],
        18: ["d"],
        19: ["d"],
        20: ["custom"], // Pregunta del canvas
      };

      function checkAnswers() {
        // Quita resaltados previos y símbolos
        document
          .querySelectorAll(".correct-answer")
          .forEach((el) => el.classList.remove("correct-answer"));
        document
          .querySelectorAll(".question-result")
          .forEach((el) => (el.textContent = ""));

        // Elimina imágenes de respuestas correctas anteriores
        document
          .querySelectorAll(".respuesta-correcta-img")
          .forEach((img) => img.remove());

        // Define las preguntas canvas (ajusta si agregas más)
        const canvasQuestions = ["20", "21", "22", "23", "24", "25"];

        // Calcula el total solo con preguntas que NO son canvas
        let total = Object.keys(correct).filter(
          (key) => !canvasQuestions.includes(key)
        ).length;
        let score = 0;

        // Evaluar pregunta del canvas separadamente (no suma score ni muestra icono)
        let canvasQuestion = document.querySelector(
          '.question-header[data-q="20"] .question-result'
        );
        const canvas = document.getElementById("shipCanvas");

        if (canvas && canvas.vectors && canvas.vectors.length > 0) {
          // NO mostrar icono de correcto/incorrecto
          // score++; // Si quieres que sume puntaje, déjalo
        } else {
          // NO mostrar icono de correcto/incorrecto
        }

        // Para el resto de las preguntas, seguir con el código original
        for (let key in correct) {
          if (canvasQuestions.includes(key)) continue; // Salta las canvas

          // Detecta si la pregunta tiene un canvas-container después del header
          const header = document.querySelector(
            '.question-header[data-q="' + key + '"]'
          );
          const hasCanvas =
            header &&
            header.nextElementSibling &&
            header.nextElementSibling.classList.contains(
              "canvas-instructions"
            ) &&
            header.nextElementSibling.nextElementSibling &&
            header.nextElementSibling.nextElementSibling.classList.contains(
              "canvas-container"
            );

          // Si tiene canvas, NO mostrar icono
          if (hasCanvas) continue;

          // Resalta las respuestas correctas
          correct[key].forEach((val) => {
            let label = document.querySelector(
              'input[name="' + key + '"][value="' + val + '"]'
            );
            if (label) label.parentElement.classList.add("correct-answer");
          });

          let selected = Array.from(
            document.querySelectorAll('input[name="' + key + '"]:checked')
          ).map((el) => el.value);
          let correctSet = new Set(correct[key]);
          let isCorrect =
            selected.length === correct[key].length &&
            selected.every((v) => correctSet.has(v));
          let headerResult = header.querySelector(".question-result");
          if (headerResult) {
            if (isCorrect) {
              headerResult.textContent = "✔️";
              headerResult.style.color = "#00ff99";
              score++;
            } else {
              headerResult.textContent = "❌";
              headerResult.style.color = "#ff5555";
            }
          }
        }

        // Mostrar resultados
        let resultHtml =
          "<h3>Resultado: " + score + "/" + total + " correctas</h3>";

        // Si todas son correctas, agregar mensaje especial
        if (score === total) {
          resultHtml +=
            '<h2 style="color: #00ff99; text-align: center; margin-top: 15px;">¡GILARDONI ESTARÍA ORGULLOSO DE VOS!</h2>';
        } else {
          resultHtml +=
            '<h2 style="color: #ff5555; text-align: center; margin-top: 15px;">¡A SEGUIR ESTUDIANDO!</h2>';
        }

        document.getElementById("result").innerHTML = resultHtml;
        document.getElementById("result").style.display = "block";

        // Después de evaluar la pregunta canvas, agrega esto para cada pregunta canvas dinámica:

        // Busca todos los canvas de preguntas agregadas dinámicamente
        document.querySelectorAll(".canvas-container").forEach((container) => {
          // Busca el id del canvas para identificar la pregunta
          const drawCanvas = container.querySelector(
            'canvas[id^="shipCanvas_"]'
          );
          if (drawCanvas) {
            // Usa la ruta guardada en el dataset, si existe
            const respuestaImg = container.dataset.respuestaImg;
            if (
              respuestaImg &&
              !container.querySelector(".respuesta-correcta-img")
            ) {
              const img = document.createElement("img");
              img.src = respuestaImg;
              img.alt = "Respuesta correcta";
              img.className = "respuesta-correcta-img";
              img.style.display = "block";
              img.style.margin = "15px auto 0 auto";
              img.style.maxWidth = "95%";
              img.style.border = "2px solid #00bfff";
              img.style.borderRadius = "6px";
              container.appendChild(img);
            }
          }
        });

        // Para la pregunta 20 (canvas fijo)
        const container20 = document
          .getElementById("shipCanvas")
          .closest(".canvas-container");
        if (
          container20 &&
          !container20.querySelector(".respuesta-correcta-img")
        ) {
          const img = document.createElement("img");
          img.src = "./correcta20.JPG"; // Debes tener esta imagen en tu carpeta
          img.alt = "Respuesta correcta";
          img.className = "respuesta-correcta-img";
          img.style.display = "block";
          img.style.margin = "15px auto 0 auto";
          img.style.maxWidth = "95%";
          img.style.border = "2px solid #00bfff";
          img.style.borderRadius = "6px";
          container20.appendChild(img);
        }

        // Deshabilita todos los checkboxes después de corregir
        document
          .querySelectorAll('input[type="checkbox"]')
          .forEach((cb) => (cb.disabled = true));

        // Sistema de puntajes en localStorage
        let stats = JSON.parse(
          localStorage.getItem("quizStats") || '{"perfect":0,"errores":0}'
        );
        if (score === total) {
          stats.perfect += 1;
        } else {
          stats.errores += 1;
        }
        localStorage.setItem("quizStats", JSON.stringify(stats));

        // Mostrar los puntajes debajo del resultado
        let statsHtml = `
          <div style="margin-top:1em;font-size:1em;">
            <strong>Veces con todas correctas:</strong> ${stats.perfect}<br>
            <strong>Veces con errores:</strong> ${stats.errores}
          </div>
        `;
        document.getElementById("result").innerHTML += statsHtml;
      }
      // Canvas para dibujo de vectores
      document.addEventListener("DOMContentLoaded", function () {
        const canvas = document.getElementById("shipCanvas");
        const resultantCanvas = document.getElementById("resultantCanvas");
        const ctx = canvas.getContext("2d");
        const resultantCtx = resultantCanvas.getContext("2d");
        const clearButton = document.getElementById("clearCanvas");
        const undoButton = document.getElementById("deshacer");
        const colorInput = document.getElementById("strokeColor");
        const fixedWidth = 3;

        let isDrawing = false;
        let startX, startY;

        // Dibuja la imagen exacta en ambos canvas
        const shipImage = new Image();
        shipImage.src = "./dextrogiro estribor.png";

        shipImage.onerror = function () {
          ctx.font = "14px Arial";
          ctx.fillStyle = "black";
          ctx.fillText(
            "Error: No se pudo cargar la imagen del buque.",
            50,
            150
          );
          resultantCtx.font = "14px Arial";
          resultantCtx.fillStyle = "black";
          resultantCtx.fillText(
            "Error: No se pudo cargar la imagen del buque.",
            50,
            150
          );
        };

        shipImage.onload = function () {
          drawShip();
          drawResultantShip();
        };

        function drawShip() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          const imgWidth = Math.min(canvas.width * 0.9, shipImage.width);
          const imgHeight = Math.min(canvas.height * 0.9, shipImage.height);
          const x = (canvas.width - imgWidth) / 2;
          const y = (canvas.height - imgHeight) / 2;

          ctx.drawImage(shipImage, x, y, imgWidth, imgHeight);
        }

        function drawResultantShip() {
          resultantCtx.clearRect(
            0,
            0,
            resultantCanvas.width,
            resultantCanvas.height
          );
          // Ya no dibujamos la imagen del buque en el canvas resultante
        }

        function drawVector(context, x1, y1, x2, y2, color, width) {
          context.beginPath();
          context.moveTo(x1, y1);
          context.lineTo(x2, y2);
          context.strokeStyle = color;
          context.lineWidth = width;
          context.stroke();

          const headlen = 10;
          const angle = Math.atan2(y2 - y1, x2 - x1);

          context.beginPath();
          context.moveTo(x2, y2);
          context.lineTo(
            x2 - headlen * Math.cos(angle - Math.PI / 6),
            y2 - headlen * Math.sin(angle - Math.PI / 6)
          );
          context.lineTo(
            x2 - headlen * Math.cos(angle + Math.PI / 6),
            y2 - headlen * Math.sin(angle + Math.PI / 6)
          );
          context.closePath();
          context.fillStyle = color;
          context.fill();
        }

        // Función para dibujar el vector resultante
        function drawResultantVectors() {
          drawResultantShip();

          if (!canvas.vectors || canvas.vectors.length === 0) return;

          // Punto inicial en el centro del canvas
          let currentX = resultantCanvas.width / 2;
          let currentY = resultantCanvas.height / 2;

          // Dibuja cada vector consecutivamente
          canvas.vectors.forEach((vector, index) => {
            // Calcula el desplazamiento relativo de este vector
            const dx = vector.end.x - vector.start.x;
            const dy = vector.end.y - vector.start.y;

            // Dibuja este vector empezando desde el punto final del anterior
            const nextX = currentX + dx;
            const nextY = currentY + dy;

            drawVector(
              resultantCtx,
              currentX,
              currentY,
              nextX,
              nextY,
              vector.color,
              vector.width
            );

            // Actualiza el punto de inicio para el siguiente vector
            currentX = nextX;
            currentY = nextY;
          });

          // Dibuja el vector resultante desde el centro hasta el punto final
          resultantCtx.beginPath();
          resultantCtx.moveTo(
            resultantCanvas.width / 2,
            resultantCanvas.height / 2
          );
          resultantCtx.lineTo(currentX, currentY);
          resultantCtx.strokeStyle = "#00FF00"; // Verde para el vector resultante
          resultantCtx.lineWidth = 4;
          resultantCtx.stroke();

          // Dibuja la flecha en el final del vector resultante
          const headlen = 12;
          const angle = Math.atan2(
            currentY - resultantCanvas.height / 2,
            currentX - resultantCanvas.width / 2
          );

          resultantCtx.beginPath();
          resultantCtx.moveTo(currentX, currentY);
          resultantCtx.lineTo(
            currentX - headlen * Math.cos(angle - Math.PI / 6),
            currentY - headlen * Math.sin(angle - Math.PI / 6)
          );
          resultantCtx.lineTo(
            currentX - headlen * Math.cos(angle + Math.PI / 6),
            currentY - headlen * Math.sin(angle + Math.PI / 6)
          );
          resultantCtx.closePath();
          resultantCtx.fillStyle = "#00FF00";
          resultantCtx.fill();
        }

        function startDrawing(e) {
          isDrawing = true;
          const rect = canvas.getBoundingClientRect();
          startX = e.clientX - rect.left;
          startY = e.clientY - rect.top;
        }

        function draw(e) {
          if (!isDrawing) return;

          const rect = canvas.getBoundingClientRect();
          const currentX = e.clientX - rect.left;
          const currentY = e.clientY - rect.top;

          ctx.save();
          drawShip();

          if (canvas.vectors) {
            canvas.vectors.forEach((vector) => {
              drawVector(
                ctx,
                vector.start.x,
                vector.start.y,
                vector.end.x,
                vector.end.y,
                vector.color,
                fixedWidth
              );
            });
          }

          drawVector(
            ctx,
            startX,
            startY,
            currentX,
            currentY,
            colorInput.value,
            fixedWidth
          );

          ctx.restore();
        }

        function stopDrawing(e) {
          if (!isDrawing) return;

          const rect = canvas.getBoundingClientRect();
          const endX = e.clientX - rect.left;
          const endY = e.clientY - rect.top;

          if (!canvas.vectors) canvas.vectors = [];
          canvas.vectors.push({
            start: { x: startX, y: startY },
            end: { x: endX, y: endY },
            color: colorInput.value,
            width: fixedWidth,
          });

          isDrawing = false;

          // Actualiza el canvas de resultante después de agregar un nuevo vector
          drawResultantVectors();
        }

        // Eventos para dibujar vectores
        canvas.addEventListener("mousedown", startDrawing);
        canvas.addEventListener("mousemove", draw);
        canvas.addEventListener("mouseup", stopDrawing);
        canvas.addEventListener("mouseout", stopDrawing);

        // Soporte para dispositivos táctiles
        canvas.addEventListener("touchstart", function (e) {
          const touch = e.touches[0];
          const mouseEvent = new MouseEvent("mousedown", {
            clientX: touch.clientX,
            clientY: touch.clientY,
          });
          canvas.dispatchEvent(mouseEvent);
          e.preventDefault();
        });

        canvas.addEventListener("touchmove", function (e) {
          const touch = e.touches[0];
          const mouseEvent = new MouseEvent("mousemove", {
            clientX: touch.clientX,
            clientY: touch.clientY,
          });
          canvas.dispatchEvent(mouseEvent);
          e.preventDefault();
        });

        canvas.addEventListener("touchend", function () {
          const mouseEvent = new MouseEvent("mouseup");
          canvas.dispatchEvent(mouseEvent);
        });

        clearButton.addEventListener("click", function () {
          canvas.vectors = [];
          drawShip();
          drawResultantShip(); // Limpia también el canvas resultante
        });

        undoButton.addEventListener("click", function () {
          if (canvas.vectors && canvas.vectors.length > 0) {
            canvas.vectors.pop();
            drawShip();

            if (canvas.vectors.length > 0) {
              canvas.vectors.forEach((vector) => {
                drawVector(
                  ctx,
                  vector.start.x,
                  vector.start.y,
                  vector.end.x,
                  vector.end.y,
                  vector.color,
                  fixedWidth
                );
              });
            }

            // Actualiza el canvas de resultante después de eliminar un vector
            drawResultantVectors();
          }
        });

        // Función para inicializar un nuevo canvas de dibujo
        function initializeCanvasQuestion(
          questionId,
          imageSrc,
          instructions,
          respuestaImg
        ) {
          // Crea un nuevo div para la pregunta
          const newQuestion = document.createElement("div");
          newQuestion.className = "question-header";
          newQuestion.setAttribute("data-q", questionId);

          // Agrega el título de la pregunta
          const title = document.createElement("h3");
          title.textContent = `${questionId}. Dibuje los vectores de las fuerzas:`;

          // Agrega el span para el resultado
          const resultSpan = document.createElement("span");
          resultSpan.className = "question-result";

          // Agrega las instrucciones personalizadas si existen
          const instructionsDiv = document.createElement("div");
          instructionsDiv.className = "canvas-instructions";
          instructionsDiv.innerHTML =
            instructions ||
            "Dibuja los vectores que representan las fuerzas actuantes en esta situación.";
          instructionsDiv.style.backgroundColor = "#34395e";
          instructionsDiv.style.padding = "10px";
          instructionsDiv.style.borderRadius = "5px";
          instructionsDiv.style.marginBottom = "10px";
          instructionsDiv.style.color = "#fff";

          // Estructura de los canvas
          const canvasContainer = document.createElement("div");
          canvasContainer.className = "canvas-container";

          const canvasRow = document.createElement("div");
          canvasRow.className = "canvas-row";

          // Canvas de dibujo
          const drawDiv = document.createElement("div");
          const drawTitle = document.createElement("h4");
          drawTitle.textContent = "Dibuja aquí:";

          const drawCanvas = document.createElement("canvas");
          drawCanvas.id = `shipCanvas_${questionId}`;
          drawCanvas.width = 400;
          drawCanvas.height = 300;

          // Canvas resultante
          const resultDiv = document.createElement("div");
          const resultTitle = document.createElement("h4");
          resultTitle.textContent = "Vector resultante:";

          const resultCanvas = document.createElement("canvas");
          resultCanvas.id = `resultantCanvas_${questionId}`;
          resultCanvas.width = 400;
          resultCanvas.height = 300;

          // Controles
          const controls = document.createElement("div");
          controls.className = "canvas-controls";

          const clearBtn = document.createElement("button");
          clearBtn.type = "button";
          clearBtn.id = `clearCanvas_${questionId}`;
          clearBtn.textContent = "Borrar dibujo";
          clearBtn.className = "clear-button"; // Añade una clase para identificar estos botones

          const undoBtn = document.createElement("button");
          undoBtn.type = "button";
          undoBtn.id = `deshacer_${questionId}`;
          undoBtn.textContent = "Deshacer"; // Acorta el texto
          undoBtn.className = "undo-button"; // Añade una clase para identificar estos botones

          const colorSpan = document.createElement("span");
          colorSpan.textContent = "Color: ";

          const colorInput = document.createElement("input");
          colorInput.type = "color";
          colorInput.id = `strokeColor_${questionId}`;
          colorInput.value = "#FF0000";

          // Ensamblar la estructura
          drawDiv.appendChild(drawTitle);
          drawDiv.appendChild(drawCanvas);

          resultDiv.appendChild(resultTitle);
          resultDiv.appendChild(resultCanvas);

          canvasRow.appendChild(drawDiv);
          canvasRow.appendChild(resultDiv);

          controls.appendChild(clearBtn);
          controls.appendChild(undoBtn);
          controls.appendChild(colorSpan);
          controls.appendChild(colorInput);

          canvasContainer.appendChild(canvasRow);
          canvasContainer.appendChild(controls);

          newQuestion.appendChild(title);
          newQuestion.appendChild(resultSpan);

          // Obtener el contenedor del formulario y añadir la nueva pregunta
          const form = document.getElementById("quizForm");
          const corregirBtn = form.querySelector(
            'button[onclick="checkAnswers()"]'
          );
          form.insertBefore(newQuestion, corregirBtn);
          form.insertBefore(instructionsDiv, corregirBtn);
          form.insertBefore(canvasContainer, corregirBtn);

          // Inicializar la funcionalidad del canvas
          const newCanvas = document.getElementById(`shipCanvas_${questionId}`);
          const newResultantCanvas = document.getElementById(
            `resultantCanvas_${questionId}`
          );
          initializeCanvasDrawing(
            newCanvas,
            newResultantCanvas,
            imageSrc,
            document.getElementById(`clearCanvas_${questionId}`),
            document.getElementById(`deshacer_${questionId}`),
            document.getElementById(`strokeColor_${questionId}`)
          );

          // Guarda la ruta de la imagen de respuesta correcta en el dataset del canvasContainer
          canvasContainer.dataset.respuestaImg = respuestaImg || "";

          // Actualizar el objeto de respuestas correctas
          correct[questionId] = ["custom"];
        }

        // Función para inicializar la funcionalidad de dibujo en un canvas
        function initializeCanvasDrawing(
          canvas,
          resultantCanvas,
          imageSrc,
          clearButton,
          undoButton,
          colorInput
        ) {
          const ctx = canvas.getContext("2d");
          const resultantCtx = resultantCanvas.getContext("2d");
          const fixedWidth = 3;

          let isDrawing = false;
          let startX, startY;

          // Cargar la imagen
          const shipImage = new Image();
          shipImage.src = imageSrc;

          shipImage.onerror = function () {
            ctx.font = "14px Arial";
            ctx.fillStyle = "black";
            ctx.fillText("Error: No se pudo cargar la imagen.", 50, 150);
          };

          shipImage.onload = function () {
            drawShip();
            drawResultantCanvas();
          };

          function drawShip() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            const imgWidth = Math.min(canvas.width * 0.9, shipImage.width);
            const imgHeight = Math.min(canvas.height * 0.9, shipImage.height);
            const x = (canvas.width - imgWidth) / 2;
            const y = (canvas.height - imgHeight) / 2;

            ctx.drawImage(shipImage, x, y, imgWidth, imgHeight);
          }

          function drawResultantCanvas() {
            resultantCtx.clearRect(
              0,
              0,
              resultantCanvas.width,
              resultantCanvas.height
            );
            // Solo limpiamos el canvas resultante, no dibujamos la imagen

            // Dibujamos un punto central de referencia
            const centerX = resultantCanvas.width / 2;
            const centerY = resultantCanvas.height / 2;
            resultantCtx.beginPath();
            resultantCtx.arc(centerX, centerY, 4, 0, Math.PI * 2);
            resultantCtx.fillStyle = "#333";
            resultantCtx.fill();
          }

          function drawVector(context, x1, y1, x2, y2, color, width) {
            // Código para dibujar vectores...
            context.beginPath();
            context.moveTo(x1, y1);
            context.lineTo(x2, y2);
            context.strokeStyle = color;
            context.lineWidth = width;
            context.stroke();

            const headlen = 10;
            const angle = Math.atan2(y2 - y1, x2 - x1);

            context.beginPath();
            context.moveTo(x2, y2);
            context.lineTo(
              x2 - headlen * Math.cos(angle - Math.PI / 6),
              y2 - headlen * Math.sin(angle - Math.PI / 6)
            );
            context.lineTo(
              x2 - headlen * Math.cos(angle + Math.PI / 6),
              y2 - headlen * Math.sin(angle + Math.PI / 6)
            );
            context.closePath();
            context.fillStyle = color;
            context.fill();
          }

          function drawResultantVectors() {
            drawResultantCanvas();

            if (!canvas.vectors || canvas.vectors.length === 0) return;

            let currentX = resultantCanvas.width / 2;
            let currentY = resultantCanvas.height / 2;

            canvas.vectors.forEach((vector) => {
              const dx = vector.end.x - vector.start.x;
              const dy = vector.end.y - vector.start.y;

              const nextX = currentX + dx;
              const nextY = currentY + dy;

              drawVector(
                resultantCtx,
                currentX,
                currentY,
                nextX,
                nextY,
                vector.color,
                vector.width
              );

              currentX = nextX;
              currentY = nextY;
            });

            // Dibujar el vector resultante
            resultantCtx.beginPath();
            resultantCtx.moveTo(
              resultantCanvas.width / 2,
              resultantCanvas.height / 2
            );
            resultantCtx.lineTo(currentX, currentY);
            resultantCtx.strokeStyle = "#00FF00";
            resultantCtx.lineWidth = 4;
            resultantCtx.stroke();

            // Dibujar la flecha
            const headlen = 12;
            const angle = Math.atan2(
              currentY - resultantCanvas.height / 2,
              currentX - resultantCanvas.width / 2
            );

            resultantCtx.beginPath();
            resultantCtx.moveTo(currentX, currentY);
            resultantCtx.lineTo(
              currentX - headlen * Math.cos(angle - Math.PI / 6),
              currentY - headlen * Math.sin(angle - Math.PI / 6)
            );
            resultantCtx.lineTo(
              currentX - headlen * Math.cos(angle + Math.PI / 6),
              currentY - headlen * Math.sin(angle + Math.PI / 6)
            );
            resultantCtx.closePath();
            resultantCtx.fillStyle = "#00FF00";
            resultantCtx.fill();
          }

          function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            startX = e.clientX - rect.left;
            startY = e.clientY - rect.top;
          }

          function draw(e) {
            if (!isDrawing) return;

            const rect = canvas.getBoundingClientRect();
            const currentX = e.clientX - rect.left;
            const currentY = e.clientY - rect.top;

            ctx.save();
            drawShip();

            if (canvas.vectors) {
              canvas.vectors.forEach((vector) => {
                drawVector(
                  ctx,
                  vector.start.x,
                  vector.start.y,
                  vector.end.x,
                  vector.end.y,
                  vector.color,
                  fixedWidth
                );
              });
            }

            drawVector(
              ctx,
              startX,
              startY,
              currentX,
              currentY,
              colorInput.value,
              fixedWidth
            );

            ctx.restore();
          }

          function stopDrawing(e) {
            if (!isDrawing) return;

            const rect = canvas.getBoundingClientRect();
            const endX = e.clientX - rect.left;
            const endY = e.clientY - rect.top;

            if (!canvas.vectors) canvas.vectors = [];
            canvas.vectors.push({
              start: { x: startX, y: startY },
              end: { x: endX, y: endY },
              color: colorInput.value,
              width: fixedWidth,
            });

            isDrawing = false;
            drawResultantVectors();
          }

          // Eventos para el canvas
          canvas.addEventListener("mousedown", startDrawing);
          canvas.addEventListener("mousemove", draw);
          canvas.addEventListener("mouseup", stopDrawing);
          canvas.addEventListener("mouseout", stopDrawing);

          // Soporte táctil
          canvas.addEventListener("touchstart", function (e) {
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent("mousedown", {
              clientX: touch.clientX,
              clientY: touch.clientY,
            });
            canvas.dispatchEvent(mouseEvent);
            e.preventDefault();
          });

          canvas.addEventListener("touchmove", function (e) {
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent("mousemove", {
              clientX: touch.clientX,
              clientY: touch.clientY,
            });
            canvas.dispatchEvent(mouseEvent);
            e.preventDefault();
          });

          canvas.addEventListener("touchend", function () {
            const mouseEvent = new MouseEvent("mouseup");
            canvas.dispatchEvent(mouseEvent);
          });

          // Botones de control
          clearButton.addEventListener("click", function () {
            canvas.vectors = [];
            drawShip();
            drawResultantCanvas();
          });

          undoButton.addEventListener("click", function () {
            if (canvas.vectors && canvas.vectors.length > 0) {
              canvas.vectors.pop();
              drawShip();

              if (canvas.vectors.length > 0) {
                canvas.vectors.forEach((vector) => {
                  drawVector(
                    ctx,
                    vector.start.x,
                    vector.start.y,
                    vector.end.x,
                    vector.end.y,
                    vector.color,
                    fixedWidth
                  );
                });
              }

              drawResultantVectors();
            }
          });
        }

        // Para agregar una nueva pregunta con una imagen diferente, puedes llamar a:
        // Comenta la siguiente línea si no quieres agregar la pregunta de inmediato
        initializeCanvasQuestion(
          "21",
          "./babor.png",
          "En un buque Monohélice CPP Levógira, con Timón a Br, 4 Ns Avante y Maquina Toda Atrás. Dibuje las distintas fuerzas que intervienen en la popa y su resultante e indique hacia donde cae la Proa.",
          "./correcta21.JPG" // Aquí pasas la imagen de la respuesta correcta
        );
        initializeCanvasQuestion(
          "22",
          "./dextrogiro estribor.png",
          "En un buque Monohélice FPP Dextrógira, con Timón a Er, 6 Ns Atrás y Maquina Toda Atrás. Dibuje las distintas fuerzas que intervienen en la popa y su resultante e indique hacia donde cae la Proa.",
          "./correcta22.JPG" // Aquí pasas la imagen de la respuesta correcta
        );
        initializeCanvasQuestion(
          "23",
          "./babor.png",
          "En un buque Monohélice FPP Dextrógira, con Timón a Br, 6 Ns Atrás y Maquina Toda Atrás. Dibuje las distintas fuerzas que intervienen en la popa y su resultante e indique hacia donde cae la Proa.",
          "./correcta23.JPG" // Aquí pasas la imagen de la respuesta correcta
        );
        initializeCanvasQuestion(
          "24",
          "./dextrogiro estribor.png",
          "En un buque Monohélice FPP Dextrógira, con Timón a Er, 8 Ns Atrás y Maquina Todo Adelante. Dibuje las distintas fuerzas que intervienen en la popa y su resultante e indique hacia donde cae la Proa.",
          "./correcta24.JPG" // Aquí pasas la imagen de la respuesta correcta
        );
        initializeCanvasQuestion(
          "25",
          "./babor.png",
          "En un buque Monohélice FPP Dextrógira, con Timón a Br, 6 Ns Atrás y Maquina Todo Adelante. Dibuje las distintas fuerzas que intervienen en la popa y su resultante e indique hacia donde cae la Proa.",
          "./correcta25.JPG" // Aquí pasas la imagen de la respuesta correcta
        );
      });

      // Función para agregar una nueva pregunta después de cargar la página
      // function addNewCanvasQuestion() {
      //   // El tercer parámetro es para las instrucciones personalizadas (puede incluir HTML)
      //     //   initializeCanvasQuestion(
      //     "23",
      //     "./dextrogiro estribor.png",
      //     "En un buque Monohélice FPP Dextrógira, con Timón a Er, 6 Ns Atrás y Maquina Toda Atrás. Dibuje las distintas fuerzas que intervienen en la popa y su resultante e indique hacia donde cae la Proa.",
      //     "./correcta22.JPG" // Aquí pasas la imagen de la respuesta correcta
      //   );
      // }
    </script>
  </body>
</html>
